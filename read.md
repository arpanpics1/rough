
We are facing a problem while writing onto the HDFS location. So we have a Kafka consumer job that consumes the data from Kafka. It syncs back onto the HDFS location. Before that, it checks onto the checkpoint that whatever data it has captured from Kafka are a subsequent message. Then it writes onto the HDFS hive table and then it updates the checkpoint location. It has already written the data onto the HDFS location and then it repeats the same way. Again, go back to Kafka, capture the subsequent payload and offset, check again onto this checkpoint and then write it onto the HDFS location and then again update the your checkpoint location. Here what we are finding is the data after writing onto the HDFS location and updating the checkpoint, we are finding that first of all after the run-line upgradation that our jobs are failing after updating the checkpoint. Then when we are restarting again, we are finding the checkpoint is on a higher offset but the data which was written onto the HDFS location is not present.
